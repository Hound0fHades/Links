<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hound Of Hades</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Satisfy&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/boxicons/2.1.4/css/boxicons.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">

  <style>
    :root{
      /* Background */
      --bg-image: url("./cerberuslinkbackground.png");
      --bg-overlay: rgba(0,0,0,.58);

      /* Card */
      --card-bg: rgba(0,0,0,.55);
      --border: rgba(255,255,255,.16);

      /* Text */
      --text: #ffffff;
      --muted: rgba(255,255,255,.80);
      --muted2: rgba(255,255,255,.62);

      /* Accent (will be set by seasonal theme) */
      --accent: #e53935;
      --accent2: #ffb300;

      /* Buttons */
      --btn: rgba(0,0,0,.65);

      /* Glow */
      --glow: rgba(255,255,255,.14);
      --glow-strong: rgba(255,180,0,.22);

      /* Sigil overlay intensity */
      --sigil-opacity: .16;
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family:'Poppins',sans-serif;
      color: var(--text);
      background:
        linear-gradient(var(--bg-overlay), var(--bg-overlay)),
        var(--bg-image);
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding: 40px 15px;
      overflow-x:hidden;
    }

    /* Subtle animated sigils overlay */
    .sigils{
      position: fixed;
      inset: 0;
      pointer-events:none;
      z-index: 0;
      opacity: var(--sigil-opacity);
      mix-blend-mode: screen;
      filter: blur(.2px);
    }

    .sigils::before,
    .sigils::after{
      content:"";
      position:absolute;
      inset:-20%;
      background-repeat: repeat;
      background-size: 360px 360px;
      transform-origin: center;
      opacity: .9;
    }

    /* Layer 1: rune ring sigils */
    .sigils::before{
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='360' height='360' viewBox='0 0 360 360'%3E%3Cg fill='none' stroke='%23ffffff' stroke-opacity='0.65'%3E%3Ccircle cx='180' cy='180' r='120' stroke-width='2'/%3E%3Ccircle cx='180' cy='180' r='75' stroke-width='1.5'/%3E%3Cpath d='M180 55 L180 75' stroke-width='2'/%3E%3Cpath d='M180 285 L180 305' stroke-width='2'/%3E%3Cpath d='M55 180 L75 180' stroke-width='2'/%3E%3Cpath d='M285 180 L305 180' stroke-width='2'/%3E%3Cpath d='M116 116 L130 130' stroke-width='2'/%3E%3Cpath d='M244 244 L230 230' stroke-width='2'/%3E%3Cpath d='M244 116 L230 130' stroke-width='2'/%3E%3Cpath d='M116 244 L130 230' stroke-width='2'/%3E%3C/g%3E%3Cg fill='none' stroke='%23ffffff' stroke-opacity='0.55'%3E%3Cpath d='M180 86 l10 16 -10 16 -10-16z'/%3E%3Cpath d='M180 242 l10 16 -10 16 -10-16z'/%3E%3Cpath d='M86 180 l16-10 16 10 -16 10z'/%3E%3Cpath d='M242 180 l16-10 16 10 -16 10z'/%3E%3C/g%3E%3C/svg%3E");
      animation: sigilSpin 120s linear infinite;
    }

    /* Layer 2: faint star-lines */
    .sigils::after{
      background-size: 520px 520px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='520' height='520' viewBox='0 0 520 520'%3E%3Cg fill='none' stroke='%23ffffff' stroke-opacity='0.38'%3E%3Cpath d='M260 70 L310 190 L440 200 L340 285 L375 415 L260 345 L145 415 L180 285 L80 200 L210 190 Z' stroke-width='2'/%3E%3Ccircle cx='260' cy='260' r='165' stroke-width='1.5'/%3E%3C/g%3E%3C/svg%3E");
      animation: sigilDrift 90s ease-in-out infinite alternate;
      opacity:.7;
    }

    @keyframes sigilSpin{
      from{ transform: rotate(0deg) scale(1); }
      to{ transform: rotate(360deg) scale(1); }
    }
    @keyframes sigilDrift{
      from{ transform: translate(-2%, -1%) rotate(-4deg) scale(1.02); }
      to{ transform: translate(2%, 1%) rotate(4deg) scale(1.04); }
    }

    main.card{
      width:100%;
      max-width: 560px;
      background: var(--card-bg);
      backdrop-filter: blur(12px);
      border:1px solid var(--border);
      border-radius:18px;
      padding: 18px 18px 22px;
      text-align:center;
      position: relative;
      z-index: 1;
      box-shadow: 0 18px 45px rgba(0,0,0,.30);
      overflow:hidden;
    }

    /* Topbar controls */
    .topbar{
      display:flex;
      gap:10px;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.22);
      color: var(--text);
      cursor:pointer;
      user-select:none;
      font-weight:800;
      font-size:.88rem;
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .pill:hover{
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(0,0,0,.18);
      border-color: rgba(255,255,255,.22);
    }
    .pill i{ font-size:18px; }

    .theme-pill{
      flex: 1;
      min-width: 210px;
      justify-content: center;
    }
    .music-pill{
      flex: 1;
      min-width: 210px;
      justify-content: center;
    }

    /* Accent strip */
    .accent-strip{
      height: 3px;
      width: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      margin: 8px 0 14px;
      opacity: .9;
    }

    .avatar{
      width:118px;
      height:118px;
      border-radius:50%;
      border:3px solid rgba(255,255,255,.95);
      object-fit:cover;
      margin: 6px auto 12px;
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
      display:block;
    }

    h1{
      font-family:'Satisfy',cursive;
      font-size:2.35rem;
      margin: 0 0 6px;
      letter-spacing:.2px;
    }

    .tagline{
      font-size:.92rem;
      color: var(--muted2);
      margin: 0 0 14px;
    }

    .socials{
      display:flex;
      justify-content:center;
      gap:18px;
      margin-bottom: 16px;
    }
    .socials a{
      color: inherit;
      font-size: 26px;
      transition: transform .2s ease, opacity .2s ease;
    }
    .socials a:hover{ transform: translateY(-3px); opacity:.86; }

    /* Tabs */
    .tabs{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-bottom: 16px;
    }
    .tab{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.30);
      color: var(--text);
      cursor:pointer;
      font-weight:800;
      font-size:.9rem;
      transition: transform .18s ease, box-shadow .22s ease;
    }
    .tab:hover{ transform: translateY(-1px); box-shadow: 0 10px 22px rgba(0,0,0,.14); }
    .tab.active{ background: rgba(255,255,255,.10); }

    /* Panels */
    .panel{ display:none; text-align:left; }
    .panel.active{ display:block; }

    .section-card{
      background: rgba(0,0,0,.25);
      border:1px solid var(--border);
      border-radius:16px;
      padding:14px;
      margin-bottom:14px;
    }

    .links{
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .link-btn{
      position:relative;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap:12px;
      padding: 14px 16px;
      border-radius:999px;
      background: var(--btn);
      border:1px solid var(--border);
      color: inherit;
      text-decoration:none;
      font-weight:900;
      overflow:hidden;
      transition: transform .18s ease, box-shadow .25s ease, border-color .25s ease;
    }

    .link-btn::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.10), transparent 45%),
        radial-gradient(circle at 70% 70%, rgba(255,255,255,.08), transparent 55%),
        radial-gradient(circle at 40% 60%, rgba(255,180,0,.22), transparent 45%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
    }
    .link-btn:hover{
      transform: translateY(-2px);
      box-shadow: 0 14px 30px rgba(0,0,0,.25);
      border-color: rgba(255,255,255,.24);
    }
    .link-btn:hover::before{ opacity:1; }

    .badge{
      font-size:.72rem;
      font-weight:900;
      padding:5px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.18);
      z-index:1;
      white-space:nowrap;
    }
    .danger{
      background: rgba(229,57,53,.16);
      border-color: rgba(229,57,53,.35);
    }

    details.about{
      border-radius:14px;
      padding: 12px 12px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.22);
    }
    details.about summary{
      list-style:none;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content: space-between;
      font-weight:900;
      user-select:none;
    }
    details.about summary::-webkit-details-marker{ display:none; }

    .about p{
      margin: 12px 0 0;
      font-size:.95rem;
      line-height:1.58;
      color: var(--muted);
    }

    .hint{
      font-size:.84rem;
      color: var(--muted2);
      margin: 10px 0 0;
    }

    footer{
      margin-top: 10px;
      text-align:center;
      font-size:.75rem;
      color: rgba(255,255,255,.6);
    }

    /* DOB Gate modal */
    .modal-overlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.65);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 9999;
    }
    .modal{
      width:100%;
      max-width:430px;
      border-radius:18px;
      background: rgba(15,12,20,.86);
      border:1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(14px);
      padding:18px 16px;
      box-shadow: 0 18px 45px rgba(0,0,0,.35);
      animation: popIn .22s ease-out;
      color:#fff;
    }
    @keyframes popIn{
      from{ transform: translateY(8px) scale(.98); opacity:0; }
      to{ transform: translateY(0) scale(1); opacity:1; }
    }
    .modal-header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .modal-title{ font-weight: 900; font-size:1.05rem; }
    .close-x{
      background:transparent;
      border:none;
      cursor:pointer;
      font-size:22px;
      color:inherit;
      opacity:.8;
    }
    .close-x:hover{ opacity:1; transform: rotate(6deg); }

    .modal p{ margin:8px 0 12px; line-height:1.45; color: rgba(255,255,255,.82); }

    .dob-row{ display:grid; gap:10px; margin: 12px 0 10px; }
    .dob-row label{ font-size:.85rem; font-weight:900; opacity:.9; }

    input[type="date"]{
      width:100%;
      padding:12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.08);
      color:inherit;
      font-family:inherit;
      font-weight:700;
    }

    .modal-actions{ display:flex; gap:10px; margin-top:10px; }
    .btn{
      flex:1;
      border:none;
      cursor:pointer;
      border-radius:12px;
      padding:12px;
      font-weight: 900;
      transition: transform .15s ease, box-shadow .2s ease;
    }
    .btn.primary{
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: #0b0b0f;
    }
    .btn.ghost{
      background: rgba(255,255,255,.10);
      color: inherit;
      border:1px solid rgba(255,255,255,.18);
    }
    .btn:hover{ transform: translateY(-1px); box-shadow: 0 14px 30px rgba(0,0,0,.20); }

    .error{
      display:none;
      margin-top:10px;
      font-weight:900;
      font-size:.9rem;
      color:#ff6b6b;
      animation: shake .25s ease;
    }
    @keyframes shake{
      0%,100%{ transform: translateX(0); }
      25%{ transform: translateX(-6px); }
      50%{ transform: translateX(6px); }
      75%{ transform: translateX(-4px); }
    }

    /* Mobile tweaks */
    @media (max-width: 480px){
      body{ padding: 26px 12px; }
      h1{ font-size: 2.05rem; }
      .tabs{ grid-template-columns: 1fr; }
      .pill{ width: 100%; justify-content:center; }
      .theme-pill, .music-pill{ min-width: unset; }
    }
  </style>
</head>

<body>
  <!-- Sigil overlay -->
  <div class="sigils" aria-hidden="true"></div>

  <main class="card">
    <!-- Top controls: Seasonal Theme + Music -->
    <div class="topbar">
      <button class="pill theme-pill" id="themeToggle" type="button" aria-label="Toggle Seasonal Theme Mode">
        <i class="bx bxs-leaf"></i>
        <span id="themeLabel">Season: Auto</span>
      </button>

      <button class="pill music-pill" id="musicToggle" type="button" aria-label="Toggle Music">
        <i class="bx bx-play"></i>
        <span id="musicLabel">Music: Off</span>
      </button>
    </div>

    <div class="accent-strip" aria-hidden="true"></div>

    <!-- Profile -->
    <img class="avatar" src="./houndsprofile.jpg" alt="Hound Of Hades" />
    <h1>Hound Of Hades</h1>
    <p class="tagline">Fantasy • Crafting • Culinary Adventures • Cosplay</p>

    <!-- Socials -->
    <div class="socials">
      <a href="https://www.instagram.com/hound.0f.hades" target="_blank" rel="noopener"><i class="bx bxl-instagram"></i></a>
      <a href="https://www.tiktok.com/@hound..of..hades" target="_blank" rel="noopener"><i class="bx bxl-tiktok"></i></a>
      <a href="https://x.com/Hound_0f_Hades" target="_blank" rel="noopener"><i class="fa-brands fa-x-twitter"></i></a>
    </div>

    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="Sections">
      <button class="tab active" data-tab="links" type="button">Links</button>
      <button class="tab" data-tab="about" type="button">About</button>
      <button class="tab" data-tab="support" type="button">Support</button>
    </div>

    <!-- Links -->
    <section class="panel active" id="panel-links">
      <div class="section-card">
        <div class="links">
          <a class="link-btn" href="https://fetlife.com/Hound0fHades" target="_blank" rel="noopener" data-dob-gated="true">
            <span>FetLife</span>
            <span class="badge danger">18+</span>
          </a>

          <a class="link-btn" href="https://www.snapchat.com/add/hound0fhades" target="_blank" rel="noopener">
            <span>Snapchat</span>
          </a>
        </div>

        <p class="hint">Glow is intentional ✨ Seasonal colors shift automatically by date.</p>
      </div>
    </section>

    <!-- About -->
    <section class="panel" id="panel-about">
      <div class="section-card">
        <details class="about">
          <summary>
            <span>About Me</span>
            <i class="bx bx-chevron-down"></i>
          </summary>
          <div class="about">
            <p>
              As a true bibliophile, I find immense joy in fantasy worlds—whether through reading or audiobooks.
              I’m an avid crafter, curious explorer, and enthusiastic culinary adventurer.
              <br><br>
              Travel fuels my spirit, especially Ireland, Scotland, and Greece, inspired by my love of mythology.
              I also enjoy cosplay and creative expression.
              <br><br>
              Above all, time spent with my loved ones, partner, and friends means the most to me.
            </p>
          </div>
        </details>
      </div>
    </section>

    <!-- Support (kept simple since you removed tips + Amazons) -->
    <section class="panel" id="panel-support">
      <div class="section-card">
        <p class="hint" style="margin:0;">Support links intentionally removed.</p>
      </div>
    </section>

    <footer>© Hound Of Hades</footer>
  </main>

  <!-- Music (Put your file in the repo as: music.mp3) -->
  <audio id="bgMusic" loop preload="none">
    <!-- ✅ Put a file named music.mp3 in the SAME folder as index.html -->
    <source src="./music.mp3" type="audio/mpeg">
  </audio>

  <!-- DOB Gate Modal -->
  <div class="modal-overlay" id="dobModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="dobTitle">
      <div class="modal-header">
        <div class="modal-title" id="dobTitle">Age Check (18+)</div>
        <button class="close-x" id="dobClose" type="button" aria-label="Close"><i class="bx bx-x"></i></button>
      </div>

      <p>This link is for adults only. Please confirm you are <strong>18+</strong> by entering your date of birth.</p>

      <div class="dob-row">
        <label for="dobInput">Date of birth</label>
        <input id="dobInput" type="date" />
      </div>

      <div class="modal-actions">
        <button class="btn ghost" id="dobCancel" type="button">Cancel</button>
        <button class="btn primary" id="dobSubmit" type="button">Continue</button>
      </div>

      <div class="error" id="dobError">Sorry — you must be 18 or older.</div>
    </div>
  </div>

  <script>
    // -----------------------------
    // Tabs
    // -----------------------------
    const tabs = document.querySelectorAll('.tab');
    const panels = {
      links: document.getElementById('panel-links'),
      about: document.getElementById('panel-about'),
      support: document.getElementById('panel-support'),
    };

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const target = tab.dataset.tab;
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        Object.values(panels).forEach(p => p.classList.remove('active'));
        panels[target].classList.add('active');
      });
    });

    // -----------------------------
    // Seasonal Pagan Theme (8 Sabbats)
    // - Auto mode picks by date (approx. fixed dates)
    // - Manual mode cycles through themes
    // -----------------------------
    const themeToggle = document.getElementById('themeToggle');
    const themeLabel = document.getElementById('themeLabel');

    // Approximate Sabbat anchor dates (Northern Hemisphere, fixed-date style)
    // We'll choose the theme whose anchor is the most recent <= today.
    const THEMES = [
      { key:"Yule",        month:12, day:21, accent:"#7dd3fc", accent2:"#a7f3d0", overlay:0.62 },
      { key:"Imbolc",      month: 2, day: 1, accent:"#fcd34d", accent2:"#fda4af", overlay:0.56 },
      { key:"Ostara",      month: 3, day:20, accent:"#86efac", accent2:"#f9a8d4", overlay:0.54 },
      { key:"Beltane",     month: 5, day: 1, accent:"#fb7185", accent2:"#fbbf24", overlay:0.50 },
      { key:"Litha",       month: 6, day:21, accent:"#fbbf24", accent2:"#fde68a", overlay:0.48 },
      { key:"Lughnasadh",  month: 8, day: 1, accent:"#f97316", accent2:"#facc15", overlay:0.52 },
      { key:"Mabon",       month: 9, day:22, accent:"#fb923c", accent2:"#a78bfa", overlay:0.56 },
      { key:"Samhain",     month:10, day:31, accent:"#a78bfa", accent2:"#fb7185", overlay:0.60 },
    ];

    function asDateForYear(theme, year){
      // month is 1-based; JS Date month is 0-based
      return new Date(year, theme.month - 1, theme.day, 0, 0, 0, 0);
    }

    function pickAutoTheme(today = new Date()){
      const y = today.getFullYear();
      // Build candidate anchor dates across year boundaries
      const candidates = THEMES.map(t => ({...t, dt: asDateForYear(t, y)}));

      // For early January, Yule anchor is in previous year, include that too
      const yule = THEMES.find(t => t.key === "Yule");
      candidates.push({...yule, dt: asDateForYear(yule, y - 1)});

      // Find most recent anchor <= today
      let chosen = candidates[0];
      for (const c of candidates){
        if (c.dt <= today && c.dt >= chosen.dt) chosen = c;
      }
      return THEMES.find(t => t.key === chosen.key) || THEMES[0];
    }

    function applyTheme(theme){
      document.documentElement.style.setProperty('--accent', theme.accent);
      document.documentElement.style.setProperty('--accent2', theme.accent2);

      // Slight overlay tuning per season (subtle only)
      const overlay = `rgba(0,0,0,${theme.overlay})`;
      document.documentElement.style.setProperty('--bg-overlay', overlay);
    }

    function getThemeMode(){
      // "auto" or "manual"
      return localStorage.getItem('hoh_theme_mode') || "auto";
    }
    function setThemeMode(mode){
      localStorage.setItem('hoh_theme_mode', mode);
    }
    function getManualThemeKey(){
      return localStorage.getItem('hoh_manual_theme') || "Samhain";
    }
    function setManualThemeKey(key){
      localStorage.setItem('hoh_manual_theme', key);
    }

    function refreshTheme(){
      const mode = getThemeMode();
      if (mode === "auto"){
        const t = pickAutoTheme();
        applyTheme(t);
        themeLabel.textContent = `Season: Auto (${t.key})`;
      } else {
        const key = getManualThemeKey();
        const t = THEMES.find(x => x.key === key) || THEMES[0];
        applyTheme(t);
        themeLabel.textContent = `Season: ${t.key}`;
      }
    }

    // Cycle: Auto -> Manual (current) -> next theme -> next -> ... (stays manual)
    themeToggle.addEventListener('click', () => {
      const mode = getThemeMode();
      if (mode === "auto"){
        // Switch to manual using current auto theme as starting point
        const auto = pickAutoTheme();
        setThemeMode("manual");
        setManualThemeKey(auto.key);
        refreshTheme();
        return;
      }

      // Manual: cycle to next theme
      const currentKey = getManualThemeKey();
      const idx = Math.max(0, THEMES.findIndex(t => t.key === currentKey));
      const next = THEMES[(idx + 1) % THEMES.length];
      setManualThemeKey(next.key);
      refreshTheme();
    });

    // Long press / right click to reset to Auto (nice little hidden trick)
    themeToggle.addEventListener('contextmenu', (e) => {
      e.preventDefault();
      setThemeMode("auto");
      refreshTheme();
    });

    refreshTheme();

    // -----------------------------
    // Music Toggle
    // - Mobile browsers require a user gesture to start audio (button click = ok)
    // - Remembers setting
    // -----------------------------
    const musicToggle = document.getElementById('musicToggle');
    const musicLabel = document.getElementById('musicLabel');
    const musicIcon = musicToggle.querySelector('i');
    const bgMusic = document.getElementById('bgMusic');

    function setMusicUI(isOn){
      musicLabel.textContent = isOn ? "Music: On" : "Music: Off";
      musicIcon.className = isOn ? "bx bx-pause" : "bx bx-play";
    }

    async function musicOn(){
      try{
        await bgMusic.play();
        localStorage.setItem('hoh_music', 'on');
        setMusicUI(true);
      }catch(err){
        // Autoplay blocked or file missing — keep UI off
        localStorage.setItem('hoh_music', 'off');
        setMusicUI(false);
      }
    }

    function musicOff(){
      bgMusic.pause();
      localStorage.setItem('hoh_music', 'off');
      setMusicUI(false);
    }

    musicToggle.addEventListener('click', () => {
      const isOn = localStorage.getItem('hoh_music') === 'on';
      if (isOn) musicOff();
      else musicOn();
    });

    // Respect saved preference, but only start music after first interaction
    // We'll set the UI immediately, and attempt play on first click anywhere if "on"
    const savedMusic = localStorage.getItem('hoh_music') === 'on';
    setMusicUI(savedMusic);

    if (savedMusic){
      const tryStartOnce = async () => {
        document.removeEventListener('click', tryStartOnce);
        await musicOn();
      };
      document.addEventListener('click', tryStartOnce, { once: true });
    }

    // -----------------------------
    // DOB Gate for 18+ links (FetLife)
    // - Remembers success for 24 hours
    // -----------------------------
    const dobModal = document.getElementById('dobModal');
    const dobInput = document.getElementById('dobInput');
    const dobError = document.getElementById('dobError');
    const dobClose = document.getElementById('dobClose');
    const dobCancel = document.getElementById('dobCancel');
    const dobSubmit = document.getElementById('dobSubmit');

    let pendingHref = null;

    function openDobModal(href){
      pendingHref = href;
      dobError.style.display = 'none';
      dobInput.value = '';
      dobModal.style.display = 'flex';
      dobModal.setAttribute('aria-hidden','false');
      setTimeout(()=>dobInput.focus(), 50);
    }

    function closeDobModal(){
      dobModal.style.display = 'none';
      dobModal.setAttribute('aria-hidden','true');
      pendingHref = null;
    }

    function calculateAge(dob){
      const today = new Date();
      let age = today.getFullYear() - dob.getFullYear();
      const m = today.getMonth() - dob.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) age--;
      return age;
    }

    function hasRecentDobApproval(){
      const stamp = localStorage.getItem('hoh_dob_ok_until');
      return stamp && Date.now() < Number(stamp);
    }

    function setDobApproval24h(){
      localStorage.setItem('hoh_dob_ok_until', String(Date.now() + 24*60*60*1000));
    }

    document.querySelectorAll('a[data-dob-gated="true"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        if (hasRecentDobApproval()) return;
        e.preventDefault();
        openDobModal(a.href);
      });
    });

    function handleDobSubmit(){
      if (!dobInput.value){
        dobError.textContent = "Please enter your date of birth.";
        dobError.style.display = 'block';
        return;
      }
      const dob = new Date(dobInput.value);
      const age = calculateAge(dob);

      if (age >= 18){
        setDobApproval24h();
        closeDobModal();
        if (pendingHref) window.open(pendingHref, "_blank", "noopener");
      } else {
        dobError.textContent = "Sorry — you must be 18 or older.";
        dobError.style.display = 'block';
        dobError.style.animation = 'none';
        void dobError.offsetWidth;
        dobError.style.animation = '';
      }
    }

    dobSubmit.addEventListener('click', handleDobSubmit);
    dobCancel.addEventListener('click', closeDobModal);
    dobClose.addEventListener('click', closeDobModal);

    dobModal.addEventListener('click', (e)=>{
      if (e.target === dobModal) closeDobModal();
    });

    document.addEventListener('keydown', (e)=>{
      if (dobModal.style.display === 'flex' && e.key === 'Escape') closeDobModal();
      if (dobModal.style.display === 'flex' && e.key === 'Enter') handleDobSubmit();
    });
  </script>
</body>
</html>
